# plot loss per epoch

import matplotlib.pyplot as plt
import numpy as np

models = ["fine-tune", "fine-tune-aug", "freeze", "freeze-aug", "re-init"]
colours = ["orangered", "orange", "green", "lime", "teal"]

fine_tune = [[12.698842, 11.441569, 10.953241, 10.545591, 10.239344, 10.005476, 9.798698, 9.561055, 9.396224, 9.221653, 9.046163, 8.895199, 8.719304, 8.606117, 8.481464, 8.391757, 8.201112, 8.043867, 7.911735, 7.792784, 7.670993, 7.591918, 7.424352, 7.276538, 7.145053, 7.106107, 6.952656, 6.813564, 6.674687, 6.601153, 6.545269, 6.411567, 6.346650, 6.223002, 6.157302, 6.023587, 5.975742, 5.966972, 5.851340, 5.799229, 5.733686, 5.695436, 5.645339, 5.604764, 5.538192], 
             [12.326333, 11.635804, 11.295497, 11.036851, 10.827697, 10.723814, 10.481899, 10.379424, 10.303318, 10.190556, 10.122669, 10.035952, 9.948083, 9.950808, 9.920079, 9.821718, 9.701609, 9.708157, 9.610660, 9.610613, 9.589355, 9.534906, 9.357187, 9.361282, 9.293932, 9.262157, 9.214848, 9.190977, 9.200291, 9.210583, 9.220019, 9.234811, 9.144964, 9.190986, 9.134871, 9.091439, 9.195422, 9.167341, 9.120724, 9.148215, 9.175228, 9.179130, 9.221091, 9.220619, 9.234340]]

fine_tune_aug = [[13.614572, 12.503049, 11.924508, 11.590975, 11.402521, 11.211618,10.950120, 10.827069, 10.606070, 10.390156, 10.273320, 10.082347, 10.040245, 9.919429, 9.775489, 9.528092, 9.498871, 9.325293, 9.280495, 9.160821, 9.100340, 9.011474, 8.878126, 8.697463, 8.622992, 8.602202, 8.452872, 8.379920, 8.343306, 8.310300, 8.155795, 8.065496, 8.031413, 8.005775, 7.912519, 7.815634, 7.627469, 7.644929, 7.512607, 7.495384, 7.393528, 7.390084, 7.366982, 7.382441, 7.242388, 7.152661, 7.039872, 6.950052, 6.964944, 6.892106, 6.916335, 6.838922, 6.846866, 6.783994, 6.660464, 6.647508, 6.654153, 6.689513, 6.649694, 6.638971, 6.651315, 6.619739, 6.565462, 6.575909, 6.560490, 6.628330, 6.549898, 6.577020], 
                 [12.382800, 11.680691, 11.295707, 11.109609, 10.864681, 10.749830, 10.678697, 10.495725, 10.323048, 10.340085, 10.153307, 10.099359, 10.079171, 9.876047, 9.835060, 9.773108, 9.713289, 9.694004, 9.597043, 9.515044, 9.608372, 9.481982, 9.494126, 9.437132, 9.388304, 9.346376, 9.335253, 9.337872, 9.235385, 9.176214, 9.207872, 9.195415, 9.197659, 9.212531, 9.198819, 9.075810, 9.075118, 9.096043, 9.083595, 9.031669, 9.055879, 8.995867, 9.097227, 8.993884, 9.080651, 8.985963, 8.956601, 8.892603, 8.910944, 8.895190, 8.897086, 8.873976, 8.927096, 8.882656, 8.856239, 8.895849, 8.942844, 8.881572, 8.837884, 8.851855, 8.839499, 8.884208, 8.860512, 8.841545, 8.858495, 8.846539, 8.866056, 8.894240]]

freeze = [[12.633266, 11.457426, 10.980124, 10.698400, 10.434484, 10.215772, 10.035679, 9.869112, 9.694413, 9.559881, 9.426245, 9.289518, 9.194991, 9.037275, 8.909142, 8.763984, 8.607970, 8.564446, 8.496186, 8.275596, 8.124055, 8.009440, 7.923220, 7.791975, 7.751252, 7.656009, 7.549033, 7.441319, 7.334034, 7.237410, 7.162346, 7.089538, 6.982394, 6.862221, 6.878090, 6.741042, 6.659432, 6.581361, 6.529198, 6.416775, 6.380289, 6.422123, 6.384722, 6.387034, 6.312501, 6.252148, 6.218137, 6.202697, 6.157403, 6.093649, 6.049339], 
          [12.315607,11.615823, 11.302141, 11.067124, 10.886966, 10.758728, 10.632330, 10.553757, 10.424714, 10.378414, 10.304328, 10.264526, 10.146904, 10.036462, 10.038245, 9.905676, 9.886163, 9.868560, 9.753492, 9.705703, 9.676680, 9.654515, 9.620505, 9.544123, 9.605750, 9.595462, 9.506143, 9.448329, 9.409906, 9.423054, 9.354433, 9.321586, 9.324661, 9.337789, 9.351385, 9.347276, 9.287101, 9.268666, 9.249515, 9.269156, 9.296723, 9.273360, 9.320879, 9.333949, 9.268713, 9.297846, 9.255875, 9.246326, 9.261825, 9.227446, 9.270850]]

freeze_aug = [[13.689299, 12.633877, 12.123392, 11.838442, 11.591838, 11.485629, 11.215504, 11.035429, 10.913893, 10.766986, 10.742867, 10.527140, 10.460648, 10.322715, 10.286959, 10.039071, 10.046838, 9.905538, 9.792064, 9.645971, 9.572663, 9.570604, 9.455047, 9.343488, 9.242414, 9.276269, 9.077242, 8.974382, 8.992215, 9.006025, 8.861440, 8.707096, 8.707621, 8.627232, 8.605460, 8.546061, 8.379234, 8.394180, 8.332603, 8.290416, 8.235556, 8.228972, 8.177270, 8.167800, 8.054858, 8.069184, 8.031130, 7.979336, 7.949501, 7.954199, 7.984082],
              [12.539904, 11.809287, 11.442554, 11.230344, 11.026372, 10.892387, 10.692400, 10.572351, 10.479679, 10.359932, 10.337188, 10.201983, 10.153507, 10.067507, 10.013229, 9.941566, 9.876035, 9.801185, 9.748676, 9.679469, 9.672906, 9.612054, 9.614593, 9.545153, 9.519369, 9.491366, 9.425357, 9.430844, 9.446946, 9.403254, 9.298147, 9.275349, 9.233045, 9.285134, 9.198393, 9.171803, 9.159676, 9.167404, 9.144528, 9.115595, 9.129909, 9.117442, 9.099148, 9.069842, 9.083406, 9.070776, 9.045644, 9.030861, 8.997108, 9.113182, 9.063481]]

re_init = [[24.821934, 18.347600, 17.831873, 17.330041, 16.938808, 16.587011, 16.248945, 15.957601, 15.672315, 15.396547, 15.135366, 14.859450, 14.603074, 14.351234, 14.073830, 13.820050, 13.593015, 13.347155, 13.081301, 12.833238, 12.578853, 12.349533, 12.079943, 11.855768, 11.608850, 11.414196, 11.208747, 10.964279, 10.712779, 10.462160, 10.213547, 10.031344, 9.818283, 9.689298, 11.574012, 11.344179, 11.128329, 10.953033, 10.790967, 10.624175, 10.454730, 10.264721, 10.112530, 9.942687], 
           [20.799025, 19.852322, 19.060224, 19.030770, 18.644111, 18.320073, 17.964287, 17.672282, 17.433923, 17.303487, 17.067613, 16.895131, 16.927453, 16.768182, 16.513948, 16.146537, 16.030258, 16.822144, 17.162449, 16.574591, 16.403682, 16.043233, 15.966571, 15.907422, 16.086653, 16.071302, 15.975143, 16.051914, 16.493755, 16.557606, 16.664383, 16.901078, 17.023919, 16.760392, 15.955565, 15.910377, 15.983483, 16.006593, 16.068458, 16.089173, 16.155773, 16.202104, 16.241362, 16.393227]]

loss = [fine_tune, fine_tune_aug, freeze, freeze_aug, re_init]

# training

fig, axs = plt.subplots(1, 2, figsize=(6.0, 3))

p1 = axs[0].plot(loss[0][0], label=models[0], color=colours[0])
p2 = axs[0].plot(loss[1][0], label=models[1], color=colours[1])
p3 = axs[0].plot(loss[2][0], label=models[2], color=colours[2])
p4 = axs[0].plot(loss[3][0], label=models[3], color=colours[3])
p5 = axs[0].plot(loss[4][0], label=models[4], color=colours[4])

axs[0].set(title="Training", yticks=np.arange(5, 30, 5), xticks=np.arange(0, 80, 10))
axs[0].set_xlabel("Epoch", size=12)
axs[0].set_ylabel("CTC Loss", size=12)

# validation

for i, model in enumerate(models):
    axs[1].plot(loss[i][1], label=models[i], color=colours[i])

axs[1].set(title="Validation", yticks=np.arange(5, 25, 5), xticks=np.arange(0, 80, 10)) #, yticks=[5, 10, 15, 20, 25]
axs[1].set_xlabel("Epoch", size=12)
axs[1].set_ylabel("CTC Loss", size=12)

fig.legend(labels = models, loc='lower center', bbox_to_anchor=(0.5, 0.05), ncol=3, fancybox=True, shadow=False, framealpha=1)
plt.subplots_adjust(top=0.85, bottom = 0.4, wspace=0.3, hspace=1)

# custom model

custom = [[0.5030, 0.1058, 0.0839, 0.0751, 0.0682, 0.0649, 0.0617, 0.0592, 0.0579, 0.0564, 0.0540, 0.0523, 0.0500, 0.0491, 0.0483, 0.0465, 0.0474, 0.0456, 0.0473, 0.0483, 0.0459, 0.0447, 0.0439, 0.0428, 0.0411, 0.0408, 0.0337, 0.0319, 0.0310, 0.0304, 0.0299, 0.0294, 0.0290, 0.0287, 0.0283, 0.0280], 
          [0.3029, 0.2760, 0.2655, 0.2632, 0.2693, 0.2367, 0.2693, 0.2561, 0.2475, 0.2724, 0.2423, 0.2582, 0.2502, 0.2105, 0.2343, 0.1945, 0.2301, 0.2431, 0.2089, 0.2051, 0.2150, 0.2091, 0.1890, 0.2083, 0.2015, 0.2066, 0.2036, 0.1993, 0.2012, 0.2001, 0.1980, 0.1976, 0.1967, 0.1950, 0.1942, 0.1943]]

fig, axs = plt.subplots(1, 1, figsize=(5, 2))
axs.plot(custom[0], label="Training", color="maroon")
axs.plot(custom[1], label="Validation", color="orange")
axs.set(yticks=np.arange(0, 0.6, 0.1))
axs.set_xlabel("Epoch", size=12)
axs.set_ylabel("Loss", size=12)
axs.legend(loc='upper center', bbox_to_anchor=(0.5, 1.10), ncol=2, fancybox=True, shadow=False, framealpha=1) 
fig.tight_layout()



